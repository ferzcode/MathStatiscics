import math

import numpy as np
from scipy import stats

# Данные выборок
sample1 = [1.669, 1.439, -0.775, -1.662, 2.089, -0.997, 1.840, 1.177, -0.085, 1.778,
           -0.193, 2.243, 0.487, 0.725, 0.108, 1.537, 0.107, -0.868, -0.953, -0.122]

sample2 = [2.884, 1.105, 0.731, 0.965, 2.244, 1.306, 0.643, 2.333, 0.241, 0.555,
           1.246, 1.928, 0.985, 1.728, 1.308, 1.804, 0.777, -0.105, 0.007, 1.138,
           2.081, -1.246, 2.274, 1.986, 2.024, 1.181, 0.714, 0.240, 0.194, 3.066]

# Размер выборок
n = len(sample1)
m = len(sample2)

# Уровень значимости
epsilon = 0.15

# Выборочные средние
mean1 = np.mean(sample1)
mean2 = np.mean(sample2)

# Выборочные дисперсии
var1 = np.var(sample1, ddof=1)
var2 = np.var(sample2, ddof=1)

# Степени свободы
df = n + m - 2

# Статистическое значение t

t_statistic = (math.sqrt((n * m) / (n + m)) * (mean1 - mean2)) / math.sqrt(((n - 1) * var1 + (m - 1) * var2) / df)

# Критическое значение t для двухстороннего теста
t_critical = stats.t.ppf(1 - epsilon / 2, df)

# Вывод результатов
print(f"Среднее выборки 1: {mean1}")
print(f"Среднее выборки 2: {mean2}")
print(f"Дисперсия выборки 1: {var1}")
print(f"Дисперсия выборки 2: {var2}")

print(f"t-статистика: {t_statistic}")
print(f"Критическое значение t: {t_critical}")

# Проверка гипотезы
if abs(t_statistic) > t_critical:
    print("Отвергаем нулевую гипотезу (средние различны).")
else:
    print("Не отвергаем нулевую гипотезу (средние равны).")

